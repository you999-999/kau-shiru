# お問い合わせ機能のセットアップ（アプリパスワードが使えない場合）

## 問題：アプリパスワードのメニューが表示されない

アプリパスワードが表示されない場合、以下の理由が考えられます：

1. **2段階認証が完全に有効化されていない**
   - 2段階認証を有効化した後、数分待ってから再度確認
   - ブラウザをリロード

2. **Google Workspaceアカウントの場合**
   - 管理者がアプリパスワードを無効化している可能性
   - 個人のGmailアカウント（@gmail.com）を使用することを推奨

3. **アカウントの種類による制限**
   - 一部のアカウントではアプリパスワードが利用できない場合があります

## 解決策1：メール送信なしでDB保存のみ使用（推奨）

現在の実装では、**メール送信に失敗してもDB保存は正常に動作します**。

### 設定方法

1. データベースマイグレーションを実行
2. 環境変数は設定せずに使用
3. Supabaseのダッシュボードでお問い合わせを確認

### Supabaseでお問い合わせを確認する方法

1. Supabaseダッシュボードにログイン
2. 「Table Editor」を開く
3. `contacts` テーブルを選択
4. お問い合わせ内容を確認

## 解決策2：メール通知をSupabase Database Webhooksで実装（無料）

SupabaseのDatabase Webhooksを使用して、新しいお問い合わせが追加されたときにメール通知を送信できます。

### 設定手順

1. Supabaseダッシュボード → 「Database」→ 「Webhooks」
2. 「Create a new webhook」をクリック
3. 以下の設定：
   - **Name**: `contact_notification`
   - **Table**: `contacts`
   - **Events**: `INSERT` のみ
   - **Type**: `HTTP Request`
   - **URL**: （後述のエンドポイントURL）
   - **HTTP Method**: `POST`

### メール送信エンドポイントの作成

Next.js API Routeを作成して、Webhookから呼び出されるエンドポイントを作成します。

## 解決策3：シンプルなメール送信API（無料プランあり）

### SendGrid（無料プラン：月100通まで）
- 登録が簡単
- 無料プランあり
- APIキーを取得して環境変数に設定

### Mailgun（無料プラン：最初の3ヶ月、その後は有料）
- 無料トライアルあり

## 推奨：まずはDB保存のみで運用

**最もシンプルな方法：**
1. メール送信機能は後回し
2. Supabaseのダッシュボードで定期的にお問い合わせを確認
3. 必要に応じて後からメール送信機能を追加

現在の実装では、メール送信が失敗してもエラーにならず、DBには正常に保存されます。
